<div class="notif-wrap">
  <!-- Bell button -->
  <button class="bell" type="button" (click)="toggle()" aria-label="Notifications" [attr.aria-expanded]="open">
    <!-- simple bell icon -->
    <span class="bell-icon">ðŸ””</span>

    <span class="badge" *ngIf="ns.unreadCount > 0">
      {{ ns.unreadCount > 99 ? '99+' : ns.unreadCount }}
    </span>
  </button>

  <!-- Dropdown -->
  <div class="dropdown" *ngIf="open" role="dialog" aria-label="Notifications">
    <div class="head">
      <div class="title">Notifications</div>
      <button class="link-btn" type="button" (click)="ns.markAllRead()">Mark all as read</button>
    </div>

    <div class="list" *ngIf="(items$ | async) as items">
      <div class="empty" *ngIf="items.length === 0">
        No notifications yet.
      </div>

      <button
        class="row"
        type="button"
        *ngFor="let n of items"
        (click)="onItemClick(n)"
        [class.unread]="!n.isRead"
      >
        <div class="avatar">
          <img *ngIf="n.avatarUrl; else fallback" [src]="n.avatarUrl" alt="" />
          <ng-template #fallback>

          </ng-template>
        </div>

        <div class="text">
          <div class="msg">{{ n.text }}</div>
          <div class="meta">
            <span class="time">{{ timeAgo(n.time) }}</span>
            <span class="dot" *ngIf="!n.isRead"></span>
          </div>
        </div>
      </button>
    </div>

    <div class="foot">
      <button class="link-btn" type="button" (click)="ns.clear()">Clear</button>
    </div>
  </div>
</div>
